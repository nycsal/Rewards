<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KakaReza Tasks</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@500;700&display=swap');
    body { font-family: 'Fredoka', sans-serif; margin:0; background: linear-gradient(120deg, #f8d7e0 10%, #e0f7fa 90%);}
    header { text-align:center; background:#ff6f61; color:#fff; padding:22px; font-size:2.1em; border-radius:0 0 24px 24px; box-shadow:0 5px 18px #0001; animation:fadeIn 1.2s;}
    main { max-width:1050px; margin:auto; padding:24px;}
    .section { background: #fff8; border-radius:20px; box-shadow:0 8px 28px #0002; margin-bottom:30px; padding:22px; animation:fadeInUp .9s;}
    h2 { margin-top:0; }
    .member-list { display:flex; flex-wrap:wrap; gap:12px;}
    .member-btn {
      display:inline-block; padding:8px 18px;
      border-radius: 18px; box-shadow:0 1px 5px #0001;
      cursor:pointer; font-weight:600; margin:2px;
      border: none;
      transition: background 0.18s, color 0.18s, transform .11s;
      font-size:1em; min-width: 0; width:auto;
      color: white;
    }
    .member-btn.selected {
      border: 2.5px solid #2228;
      transform: scale(1.06);
    }
    .member-btn:active {transform:scale(.96);}
    button, select, input[type="text"], input[type="date"], input[type="number"] { margin:7px 2px; padding:10px; border-radius:8px; border:none; font-size:1.05em;}
    button:not(.member-btn) { background:#ff6f61; color:#fff; cursor:pointer; font-weight: 700;}
    button:not(.member-btn):hover, .complete-btn:hover { background:#ff3b2f;}
    input[type='range'] { width:120px;}
    .hearts { color:#ff4a3a; font-size:1.13em; display:inline-block; font-weight:900; vertical-align:-2px; animation:pulse .9s infinite alternate;}
    .task { display:flex; justify-content:space-between; align-items:center; background:#f5fff7; padding:10px 8px; margin:10px 0; border-radius:12px; box-shadow:0 1px 5px #0001;}
    .complete-btn { background:#35c77e; color: white;}
    .summary { font-size:1.23em; color:#352;}
    .pb-container{ background:#d3f1e7; border-radius:7px; width:90%; height:12px; overflow:hidden; margin:6px 0;}
    .pb-bar{height:100%; background:linear-gradient(90deg,#ff6f61 40%,#f5f52d 100%); width:0;}
    .reward{color:#ffae00;font-weight:700; animation:rewardpop 1.3s;}
    @keyframes fadeIn { 0%{opacity:0;} 100%{opacity:1;} }
    @keyframes fadeInUp { 0%{opacity:0;transform:translateY(30px);} 100%{opacity:1;transform:translateY(0);} }
    @keyframes pulse { from{transform:scale(1);} to{transform:scale(1.14);} }
    @keyframes rewardpop {0%{transform:scale(1)}30%{transform:scale(1.26)}60%{transform:scale(1.1)}100%{transform:scale(1)}}
    @media (max-width:700px){
      main{padding:8px;}
      .member-list{flex-direction:column;gap:6px;}
    }
    input[type=number]::-webkit-inner-spin-button, 
    input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    input[type=number] { -moz-appearance: textfield; }
    .tiny-instructions {
      background:#fff3; border-radius:12px; padding:6px 16px; margin:12px 0 18px 0; font-weight:500; color:#444; font-size:1.07em; text-align:center;
    }
    .editinputs input, .editinputs select {
      margin: 2px 2px 2px 0;
      padding: 4px 7px;
      border-radius: 6px;
      font-size: .98em;
    }
    .edit-btn, .del-btn {
      margin-left: 6px; font-size: .99em;
      padding: 6px 11px!important;
      border-radius:8px!important;
    }
    .edit-btn { background: #ffc107!important; color: #222; }
    .del-btn { background: #e67c7c!important; color: #fff;}
    .save-btn { background: #3bb855!important; color: #fff;}
    .cancel-btn {background: #bbb!important; color: #333;}
  </style>
</head>
<body>
<header>KakaReza Tasks</header>
<main>
  <div class="tiny-instructions">
    Add a member, assign chores, and earn your reward!
  </div>
  <div class="section">
    <h2>Add a Family Member</h2>
    <input type="text" id="memberName" placeholder="Enter name" style="width:150px"/>
    <input type="text" id="giftName" placeholder="Reward/Gift (e.g. Bike)" style="width:110px"/>
    <input type="number" id="memberRewardTarget" min="1" max="999" value="30" style="width:60px" />
    <button onclick="addMember()">Add Member</button>
    <br><small>Each member: Name, their dream reward, and hearts needed!</small>
    <div class="member-list" id="memberList"></div>
  </div>
  <div class="section" id="choreSection" style="display:none">
    <h2>Assign Chore to <span id="selectedMemberName"></span></h2>
    <label><b>Chore:</b> </label>
    <select id="choreSelect"></select><br/>
    <label><b>Difficulty (Hearts):</b> <span id="rangeVal">5</span> </label>
    <input type="range" min="1" max="10" value="5" id="difficultyRange" oninput="updateSlider(this.value)">
    <span class="hearts" id="heartsDisplay">❤️❤️❤️❤️❤️</span><br>
    <label>Due Date: </label>
    <input type="date" id="dueDate"/>
    <button onclick="assignChore()">Assign Chore</button>
    <div id="assignedTasks"></div>
  </div>
  <div class="section">
    <h2>Family Dashboard</h2>
    <div class="dashboard-list" id="summaryList"></div>
  </div>
</main>
<script>
let choreList = [
"Make your bed","Feed the pets","Pick up toys","Brush teeth","Put away dirty clothes","Set the table","Clear the table","Water houseplants","Pack backpack","Sweep kitchen","Wipe counters","Help with groceries","Fold laundry","Put away clean dishes","Take out trash","Recycling","Dust shelves","Match socks","Brush hair","Help unpack groceries","Organize shoes","Help mom with shopping list","Help dad put tools away","Sharpen pencils","Straighten couch cushions","Wipe doorknobs","Help make lunch","Help pack snacks","Load dishwasher","Unload dishwasher","Wipe mirrors","Tidy entryway","Help sweep porch","Feed fish","Brush dog/cat","Rake leaves","Pick up sticks in yard","Weed garden","Water outside plants","Sweep garage","Clean car handles","Wipe table","Help mom sort mail","Help dad collect laundry","Make sibling’s bed","Sort socks","Wipe baseboards","Pick up yard toys","Put napkins on table","Take dirty towels to laundry","Empty small trash cans","Fill pet water bowl","Wipe up spills","Fold towels","Help put away groceries","Straighten play area","Clean up arts+crafts","Put sports kits away","Stack books neatly","Polish shoes","Rinse bath toys","Wash fruit & veggies","Turn off TV when done","Help dad sweep patio","Pick up after picnic","Help mom check lists","Offer water to guests","Shake out mats","Wipe refrigerator handles","Practice reading to parent","Make lunch for school","Wipe appliance fronts","Help dad pull weeds","Help mom water garden","Sweep walkways","Collect sticks in yard","Organize DVDs/games","Help dad with computer","Help mom sort recycling","Make cards for family","Brush doormat","Care for indoor plants","Pick up fallen leaves","Fill bird feeder","Organize board games","Help mom cook dinner","Help dad check garage","Get the mail","Put dishes in sink","Help prep salad","Tidy bathroom counter","Wash windows (low)","Empty lunchbox after school","Help dad with emails","Help mom with phone calls","Organize magazine rack","Help dad carry tools","Tidy shoes at door","Carry groceries up steps","Pat dog/cat gently"
];
function getColorForIndex(i){
  const colors = [
    "#ff6561","#67b7dc","#ffae00","#62b482",
    "#d456c2","#4fc9c2","#cb8db0","#e38a26","#7d7aec","#cb573e"
  ];
  return colors[i%colors.length];
}
let members = {};
let selectedMember = null;
if(localStorage.getItem('kakar-members2')) members = JSON.parse(localStorage.getItem('kakar-members2'));
const choreSelect = document.getElementById('choreSelect');
function fillChores(){
  choreSelect.innerHTML = "";
  choreList.forEach(chore=>{
    let opt = document.createElement('option');
    opt.textContent = chore;
    choreSelect.appendChild(opt);
  });
}
fillChores();
function updateSlider(val){
  document.getElementById('rangeVal').innerText = val;
  document.getElementById('heartsDisplay').innerHTML = "❤️".repeat(val);
}
updateSlider(document.getElementById('difficultyRange').value);
function saveMembers(){ localStorage.setItem('kakar-members2',JSON.stringify(members)); }
function addMember(){
  const name = document.getElementById('memberName').value.trim();
  const gift = document.getElementById('giftName').value.trim() || "Surprise!";
  const rewardTarget = parseInt(document.getElementById('memberRewardTarget').value) || 30;
  if(!name || members[name]) return;
  let color = getColorForIndex(Object.keys(members).length);
  members[name] = { tasks:[], hearts:0, reward:false, gift:gift, rewardTarget:rewardTarget, color:color };
  saveMembers();
  updateMemberList();
  updateSummary();
  document.getElementById('memberName').value = '';
  document.getElementById('giftName').value = '';
  document.getElementById('memberRewardTarget').value = '30';
}
function updateMemberList(){
  let container = document.getElementById('memberList');
  container.innerHTML = "";
  let idx = 0;
  Object.keys(members).forEach(name=>{
    let btn = document.createElement('button');
    btn.className = "member-btn" + (selectedMember===name ? " selected" : "");
    btn.textContent = name;
    btn.style.background = members[name].color;
    btn.onclick = ()=> selectMember(name);
    container.appendChild(btn);
    idx++;
  });
}
function selectMember(name){
  selectedMember = name;
  document.getElementById('selectedMemberName').textContent = name;
  document.getElementById('choreSection').style.display = 'block';
  updateMemberList();
  updateTaskList();
}
function assignChore(){
  const taskName = document.getElementById('choreSelect').value;
  const due = document.getElementById('dueDate').value;
  const difficulty = parseInt(document.getElementById('difficultyRange').value);
  if(!selectedMember || !taskName) return;
  let chore = { name:taskName, assigned:(new Date()).toLocaleDateString(), due:due, difficulty:difficulty, completed:false };
  members[selectedMember].tasks.push(chore);
  saveMembers();
  updateTaskList();
  updateSummary();
}
// --- BEGIN: EDIT AND DELETE TASK LOGIC WITH UI ---
function updateTaskList(){
  const container = document.getElementById('assignedTasks');
  container.innerHTML = "";
  members[selectedMember].tasks.forEach((task,i)=>{
    let div = document.createElement('div');
    div.className = 'task';
    let hearts = "❤️".repeat(task.difficulty);
    if(task.editing){
      // Edit mode
      div.innerHTML = `
        <span class="editinputs">
          <input type="text" value="${task.name}" id="editName${i}" style="width:120px"/>
          <input type="date" value="${task.due || ""}" id="editDue${i}"/>
          <input type="number" min="1" max="10" value="${task.difficulty}" id="editDiff${i}" style="width:51px"/>
          <button class="save-btn" onclick="saveEditTask(${i})">Save</button>
          <button class="cancel-btn" onclick="cancelEditTask(${i})">Cancel</button>
        </span>
      `;
    } else {
      div.innerHTML = `<div>
        <strong>${task.name}</strong><br>
        <span class="hearts">${hearts}</span>
        <small>(Assigned ${task.assigned}${task.due?`, Due: ${task.due}`:""})</small>
      </div>`;
      if(!task.completed){
        let btn = document.createElement('button');
        btn.textContent = 'Mark Complete';
        btn.className = 'complete-btn';
        btn.onclick = ()=> markComplete(i);
        div.appendChild(btn);

        // Edit and Delete buttons
        let editBtn = document.createElement('button');
        editBtn.textContent = 'Edit';
        editBtn.className='edit-btn';
        editBtn.onclick = ()=> editTask(i);
        div.appendChild(editBtn);

        let delBtn = document.createElement('button');
        delBtn.textContent = 'Delete';
        delBtn.className='del-btn';
        delBtn.onclick = ()=> deleteTask(i);
        div.appendChild(delBtn);

      } else {
        div.innerHTML += `<div class="hearts">✅ Completed</div>`;
      }
    }
    container.appendChild(div);
  });
}
function editTask(i){
  members[selectedMember].tasks[i].editing = true;
  updateTaskList();
}
function deleteTask(i){
  members[selectedMember].tasks.splice(i, 1);
  saveMembers();
  updateTaskList();
  updateSummary();
}
function saveEditTask(i){
  let task = members[selectedMember].tasks[i];
  let newName = document.getElementById('editName'+i).value.trim() || task.name;
  let newDue = document.getElementById('editDue'+i).value;
  let newDiff = parseInt(document.getElementById('editDiff'+i).value)||task.difficulty;
  task.name = newName;
  task.due = newDue;
  task.difficulty = newDiff;
  delete task.editing;
  saveMembers();
  updateTaskList();
  updateSummary();
}
function cancelEditTask(i){
  delete members[selectedMember].tasks[i].editing;
  updateTaskList();
}
// --- END: EDIT AND DELETE TASK LOGIC ---
function markComplete(idx){
  let task = members[selectedMember].tasks[idx];
  if(!task.completed){
    task.completed = true;
    members[selectedMember].hearts += task.difficulty;
    if(members[selectedMember].hearts >= members[selectedMember].rewardTarget && !members[selectedMember].reward){
      members[selectedMember].reward = true;
      setTimeout(()=>alert(`${selectedMember} earned enough hearts for their reward: 🎁 ${members[selectedMember].gift}`), 160);
    }
  }
  saveMembers();
  updateTaskList();
  updateSummary();
}
function updateSummary(){
  let container = document.getElementById('summaryList');
  container.innerHTML = "";
  Object.keys(members).forEach(name=>{
    let M = members[name];
    let heartsEarned = M.hearts||0;
    let progressPerc = Math.min(heartsEarned/M.rewardTarget,1)*100;
    let rewardGot = !!M.reward && heartsEarned>=M.rewardTarget;
    let outer = document.createElement('div');
    outer.className = "member";
    outer.style.background = M.color+"22";
    let bar = `<div class="pb-container"><div class="pb-bar" style="width:${progressPerc}%;background:${M.color||'#ff6f61'}"></div></div>`;
    outer.innerHTML = `<b>${name}</b> <span style="font-size:1.07em;">🎁 <b>${M.gift||"–"}</b></span>
      <br><span class="hearts">${"❤️".repeat(Math.min(heartsEarned,30))}</span>
      <br>Hearts: <b>${heartsEarned}</b> / <b>${M.rewardTarget}</b> needed
      ${bar}
      ${rewardGot ? `<div class="reward">Unlocked! 🎉 (${M.gift})</div>`:""}`;
    container.appendChild(outer);
  });
  setTimeout(() => {
    document.querySelectorAll('.pb-bar').forEach(bar=>{
      bar.style.transition = 'width 1s cubic-bezier(.4,2,.6,1)';
    });
  },30);
}
updateMemberList();
updateSummary();
</script>
</body>
</html>
